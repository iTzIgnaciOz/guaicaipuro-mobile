<!DOCTYPE html>
<html lang="en">
<head>
  <script>
    if(window.localStorage.getItem("username")){

      window.location.href="home.html";
    }
  </script>

  <title>MPPE-App Login</title>

  <!-- BEGIN META -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="MPPE,android, app, Ministerio de Educacion">
  <meta name="description" content="Aplicacioin Android MPPE">
  <!-- END META -->

  <!-- BEGIN STYLESHEETS -->
  <link href='http://fonts.googleapis.com/css?family=Roboto:300italic,400italic,300,400,500,700,900' rel='stylesheet' type='text/css'/>
  <link type="text/css" rel="stylesheet" href="css/theme/bootstrap.css" />
  <link type="text/css" rel="stylesheet" href="css/theme/materialadmin.css" />
  <link type="text/css" rel="stylesheet" href="css/theme/font-awesome.min.css" />
  <link type="text/css" rel="stylesheet" href="css/theme/toastr/toastr.css" />
  <link type="text/css" rel="stylesheet" href="css/theme/material-design-iconic-font.min.css" />
  <!-- END STYLESHEETS -->

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script type="text/javascript" src="../assets/js/libs/utils/html5shiv.js?1403934957"></script>	
		<script type="text/javascript" src="../assets/js/libs/utils/respond.min.js?1403934956"></script>
		<![endif]-->
	</head>
	<body class="menubar-hoverable">
    <div class="loader fixed hide"></div>
    <!-- BEGIN LOGIN SECTION -->
    <section class="section-account">
    <div class="img-backdrop" style="background-image: url('../img/banner.png')" ></div>
     <div class="spacer">
    <center><img  style="margin-top:20px; margin-bottom:-20px;" src="img/logo_big.png" id="logo_login"></center>
    </div>
    <div id="wait"></div>
        <!--   <div id="spinner" class="hide spinner">
               <div></div>
               <div></div>
               <div></div>
             </div>-->
             <div class="card contain-md style-transparent">
              <div class="card-body">
               <div class="row">
                <div  class="col-sm-12">
                 <br/>
                 <span class="text-lg text-bold text-primary">MPPE</span>
                 <br/><br/>

                 <form name="loginForm" id="loginForm" class="form floating-label" novalidate="novalidate" name="registerForm">
                  <div class="form-group">
                   <input type="text" data-rule-minlength="2" required class="form-control" id="username" name="username" >
                   <label for="username">Usuario</label>

                 </div>
                 <div class="form-group">
                   <input type="password" required class="form-control" id="password" name="password" >
                   <label for="password">Contraseña</label>

                   <!--<p class="help-block"><a href="#/forgot">¿Olvidaste tu Contraseña?</a></p>-->
                 </div>
                 <br/>
                 <div class="row">
                   <div class="col-xs-6 text-left">

										<!--<div class="checkbox checkbox-inline checkbox-styled">
											<label>
												<input type="checkbox"> <span>Recuerdame</span>
											</label>
										</div>-->
									</div><!--end .col -->
									<div class="col-xs-6 text-right">
										<button class="btn btn-primary btn-raised" type="submit">Login</button> 
									</div><!--end .col -->
								</div><!--end .row -->
							</form>
						</div><!--end .col -->

          </div><!--end .row -->
        </div><!--end .card-body -->
      </div><!--end .card -->
    </section>
    <!-- END LOGIN SECTION -->

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>


        <!-- Libs
        <script type="text/javascript" src="phonegap.js"></script>
        <script type="text/javascript" src="lib/angular/angular.js"></script>
        <script type="text/javascript" src="lib/angular/angular-route.js"></script>
      -->
      <!--Dependencias Theme-->
      <script src="plugins/js/libs/jquery/jquery-1.11.2.min.js"></script>
      <script src="plugins/js/libs/jquery/jquery-migrate-1.2.1.min.js"></script>
      <script src="plugins/js/libs/bootstrap/bootstrap.min.js"></script>
      <script src="plugins/js/libs/spin.js/spin.min.js"></script>
      <script src="plugins/js/libs/autosize/jquery.autosize.min.js"></script>
      <script src="plugins/js/libs/nanoscroller/jquery.nanoscroller.min.js"></script>
      <script src="plugins/js/libs/jquery-validation/dist/jquery.validate.js"></script>
      <script src="plugins/js/libs/jquery-validation/dist/additional-methods.min.js"></script>
      <script src="plugins/js/libs/toastr/toastr.js"></script>
      <script src="plugins/js/core/source/App.js"></script>
      <script src="plugins/js/core/source/AppForm.js"></script>

         <!--  <script src="plugins/js/core/source/AppNavigation.js"></script>
        <script src="plugins/js/core/source/AppOffcanvas.js"></script>
        <script src="plugins/js/core/source/AppCard.js"></script>
        
        <script src="plugins/js/core/source/AppNavSearch.js"></script>
        <script src="plugins/js/core/source/AppVendor.js"></script>
        <script src="plugins/js/core/demo/Demo.js"></script>-->


        <!-- App 
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/app.js"></script>
        <script type="text/javascript" src="js/services.js"></script>
        <script type="text/javascript" src="js/controllers.js"></script>
      -->
      <script type="text/javascript">
        app.initialize();

        function showForm(){
         $('#registerForm').removeClass('hide');
         $('#is_register').addClass('hide');

       }


       $(document).ready(function(){
        toastr.options = {
          "closeButton": false,
          "debug": false,
          "newestOnTop": false,
          "progressBar": false,
          "positionClass": "toast-bottom-center",
          "preventDuplicates": false,
          "onclick": null,
          "showDuration": "300",
          "hideDuration": "1000",
          "timeOut": "5000",
          "extendedTimeOut": "1000",
          "showEasing": "swing",
          "hideEasing": "linear",
          "showMethod": "fadeIn",
          "hideMethod": "fadeOut"
        }


        $("#registerForm").validate({
          submitHandler: function(form) {
    //$(form).ajaxSubmit();
  }
});


        $("#loginForm").validate({

          submitHandler: function(form) {


            $.ajax({
              type:'GET',
              data:$("#loginForm").serialize()+'&action=login',
              url:'http://estadistica.gescolar.me.gob.ve/',
              dataType:'json',
              beforeSend:function(){
                $('.loader').removeClass('hide');
              },
              success:function(response){

                $('.loader').addClass('hide');

                if(response.success){
    //create cookies and go to the home
    window.localStorage.setItem("nombre", response.nombre);
    window.localStorage.setItem("apellido", response.apellido);
    window.localStorage.setItem("username", response.username);
    
    var nombre = window.localStorage.getItem("nombre");

    window.location.href="home.html";

  }else if(response.errors){
   $('.loader').addClass('hide');
   toastr.error(response.mensaje,'');
        //show error
      }else{
        $('.loader').addClass('hide');
        toastr.error(response.mensaje,'');
        //show error
      }
    },
    error: function (xhr, ajaxOptions, thrownError) {
      $('.loader').addClass('hide');
      toastr.error(  xhr.status+' '+thrownError,'');
        //alert(xhr.status);
        //alert(thrownError);
      }
    });

}

});

});
</script>

</body>
</html>
